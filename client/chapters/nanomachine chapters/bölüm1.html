<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Nano Machine - Bölüm 1 | ToonNeko</title>
  
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="//localhost">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="preload" href="../../styles/navbar.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="../../styles/navbar.css?v=5"></noscript>
  <link rel="preload" href="../../styles/ornek-navbar-ek.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="../../styles/ornek-navbar-ek.css?v=5"></noscript>
  <link rel="preload" href="../../styles/seri.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="../../styles/seri.css?v=5"></noscript>
  <link rel="preload" href="../../styles/enhanced-navigation.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="../../styles/enhanced-navigation.css?v=5"></noscript>
  <link rel="stylesheet" href="../../styles/dynamic-navigation.css?v=50">
  <link rel="preload" href="../../styles/okuma.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="../../styles/okuma.css?v=5"></noscript>
  <link rel="preload" href="../../styles/comments.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="../../styles/comments.css?v=5"></noscript>
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css?v=5" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css?v=5"></noscript>
  <style>
    body { opacity: 0; transition: opacity 1s ease-in; }
    body.loaded { opacity: 1; }
    button, .section-bar { transition: transform 0.2s, box-shadow 0.2s; }
    button:hover, .section-bar:hover { transform: scale(1.08); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
    #scrollTopBtn { display: none; position: fixed; bottom: 30px; right: 30px; z-index: 99; font-size: 22px; background: #222; color: #fff; border: none; border-radius: 50%; width: 48px; height: 48px; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.2); transition: background 0.3s, transform 0.2s, opacity 0.2s; opacity: 0.65; }
    #scrollTopBtn:hover { background: #ff6f61; transform: scale(1.1); opacity: 1; }
    .logo-link { display: flex; align-items: center; text-decoration: none !important; color: inherit !important; cursor: pointer; }
    .logo-link:visited, .logo-link:active, .logo-link:hover { color: inherit !important; text-decoration: none !important; }
    .logo-link img { margin-right: 8px; }
    
    /* Force consistent logo size */
    .logo-area img {
      height: 64px !important;
      width: auto !important;
    }
    .logo-area span {
      font-size: 3.2rem !important;
      font-weight: bold !important;
    }
    
    /* Force consistent navbar margin */
    .desktop-navbar {
      margin-left: 20px !important;
    }
    header {
      padding: 10px 15px !important;
    }
    
    /* Chapter sayfasında hamburger ve side menu'yu görünür yap */
    @media (max-width: 1366px) {
      .hamburger {
        display: flex !important;
      }
      .side-menu,
      .side-overlay {
        display: block !important;
      }
      .desktop-navbar {
        display: none !important;
      }
    }
    
    @media (min-width: 1367px) {
      .hamburger {
        display: none !important;
      }
      .desktop-navbar {
        display: flex !important;
      }
    }
    
    .okuma-header { display: flex; align-items: center; justify-content: space-between; max-width: 1000px; margin: 40px auto 0 auto; padding-left: 20px; padding-right: 20px; }
    .okuma-header .seri-link { font-size: 1.2em; color: #ff6f61; text-decoration: none; display: flex; align-items: center; margin: 0 !important; padding: 0 !important; }
    .okuma-header .fav-btn { background: none; border: none; color: #ff6f61; font-size: 1.5em; cursor: pointer; display: flex; align-items: center; margin: 0 !important; padding: 8px 12px !important; position: relative; border-radius: 8px; transition: all 0.3s ease; z-index: 100; }
    .okuma-header .fav-btn i { font-family: 'Font Awesome 6 Free'; font-weight: 900; transition: all 0.3s ease; }
    .okuma-header .fav-btn .fa-bookmark { color: #ff6f61; transition: all 0.3s ease; }
    .okuma-header .fav-btn:hover { background: rgba(255, 111, 97, 0.1); transform: scale(1.1); }
    .okuma-header .fav-btn.bookmarked { color: #ff6f61; background: rgba(255, 111, 97, 0.2); animation: bookmark-pulse 2s ease-in-out; }
    .okuma-header .fav-btn.bookmarked i { color: #ff6f61; text-shadow: 0 0 8px rgba(255, 111, 97, 0.5); animation: bookmark-glow 2s ease-in-out; }
    .okuma-header .fav-btn.has-other-bookmark { color: #ffa500; animation: bookmark-warning 1s ease-in-out; }
    
    /* Bookmark Animasyonları */
    @keyframes bookmark-pulse {
      0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 111, 97, 0.7); }
      50% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(255, 111, 97, 0); }
      100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 111, 97, 0); }
    }
    
    @keyframes bookmark-glow {
      0%, 100% { text-shadow: 0 0 8px rgba(255, 111, 97, 0.5); }
      50% { text-shadow: 0 0 15px rgba(255, 111, 97, 0.8), 0 0 25px rgba(255, 111, 97, 0.5); }
    }
    
    @keyframes bookmark-warning {
      0%, 100% { transform: scale(1); }
      25% { transform: scale(1.05) rotate(-2deg); }
      75% { transform: scale(1.05) rotate(2deg); }
    }
    
    /* Bookmark buton hover ve active states */
    .okuma-header .fav-btn:active {
      transform: scale(0.95);
      transition: transform 0.1s ease;
    }
    
    .okuma-header .fav-btn.clicked {
      animation: bookmark-click 0.6s ease-out;
    }
    
    @keyframes bookmark-click {
      0% { transform: scale(1); }
      20% { transform: scale(1.2) rotate(5deg); }
      40% { transform: scale(1.1) rotate(-3deg); }
      60% { transform: scale(1.05) rotate(2deg); }
      80% { transform: scale(1.02) rotate(-1deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    .okuma-header .fav-btn.has-other-bookmark:hover { background: rgba(255, 165, 0, 0.1); }
    .okuma-header .fav-btn.bookmarked:hover { background: rgba(255, 111, 97, 0.3); }
    .okuma-nav { display: flex; align-items: center; justify-content: center; gap: 18px; margin: 24px 0 16px 0; flex-wrap: wrap; }
    .okuma-nav button, .okuma-nav a { padding: 10px 22px; border-radius: 8px; border: none; background: #222; color: #fff; font-size: 1.1em; cursor: pointer; text-decoration: none; transition: background 0.2s; display: flex; align-items: center; gap: 6px; }
    .okuma-nav button:disabled { background: #888; cursor: not-allowed; }
    .okuma-nav button:hover:not(:disabled) { background: #333; }
    .okuma-nav .info-btn { background: #ff6f61; color: #fff; }
    .okuma-nav .info-btn:hover { background: #e55a4d; }
    .okuma-nav span { font-size: 1.1em; font-weight: 600; color: #ff6f61; width: 100%; text-align: center; margin-bottom: 6px; }
    .okuma-nav-inner { display: flex; gap: 18px; justify-content: center; width: 100%; }
    @media (max-width: 600px) {
      .okuma-header { flex-direction: column; align-items: flex-start; gap: 8px; }
      .okuma-nav { flex-direction: column; gap: 0; margin: 18px 0 10px 0; }
      .okuma-nav span { order: -1; margin-bottom: 8px; }
      .okuma-nav-inner { flex-direction: row; gap: 10px; justify-content: center; width: 100%; }
    }
    .okuma-header .fav-btn { margin-left: 24px; margin-right: 0; position: relative; left: 0; right: 0; }
    @media (max-width: 600px) {
      .okuma-header { align-items: center; }
      .okuma-header .fav-btn { margin: 12px auto 0 auto; left: 0; right: 0; display: block; }
    }
    .okuma-alani { background: #181818; border-radius: 12px; padding: 16px; margin-bottom: 32px; display: flex; flex-direction: column; align-items: center; }
    .okuma-alani img {
      max-width: 100vw;
      width: 100vw;
      display: block;
      margin: 0;
      border-radius: 0;
      box-shadow: none;
    }
    @media (min-width: 601px) {
      .okuma-alani img {
        max-width: 700px;
        width: 80vw;
        margin: 0 auto;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.12);
      }
    }
    .comments { margin: 32px 0; }
    @media (max-width: 600px) { .okuma-header { flex-direction: column; align-items: flex-start; gap: 8px; } .okuma-nav { flex-direction: column; gap: 8px; } }
    .custom-select {
      border-radius: 18px;
      background: linear-gradient(90deg, #232323 60%, #ff6f61 100%);
      color: #fff;
      border: 2px solid #ff6f61;
      padding: 8px 18px;
      font-size: 1em;
      font-weight: 600;
      margin: 0 6px;
      outline: none;
      transition: border 0.2s, background 0.2s, color 0.2s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      cursor: pointer;
    }
    .custom-select:focus {
      border: 2px solid #fff;
      background: linear-gradient(90deg, #ff6f61 60%, #232323 100%);
      color: #fff;
    }
    .custom-select option {
      background: #232323;
      color: #ff6f61;
      border-radius: 12px;
    }
    
    /* Bölüm1.html için özel navbar styling - sticky position'ı kaldır */
    body.okuma-sayfasi header {
      position: static !important;
      box-shadow: none;
    }
    
    /* Okuma sayfası için özel navbar stilleri - navbar.css'teki styling'leri override etmiyoruz */
    body.okuma-sayfasi .search-container {
      background: rgba(18, 18, 18, 0.95);
      backdrop-filter: blur(10px);
    }
    
    body.okuma-sayfasi .okuma-alani {
      margin-top: 20px;
    }
    
    /* Responsive adjustments - header styling'lerini navbar.css'e bırakıyoruz */
    @media (max-width: 480px) {
      #scrollTopBtn {
        bottom: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
        font-size: 18px;
      }
    }

    .okuma-stil-secici {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      margin: 16px 0 24px 0;
      flex-wrap: wrap;
    }

    @media (max-width: 600px) {
      .okuma-stil-secici {
        flex-direction: column;
        gap: 8px;
      }
      .custom-select {
        margin: 4px 0;
        width: 200px;
      }
    }

    /* Bookmark Alert Styles */
    .alert {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      margin: 8px 0;
      border-radius: 8px;
      font-weight: 500;
      opacity: 1;
      transition: opacity 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 1000;
    }
    
    .alert-success {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      border-left: 4px solid #2e7d32;
    }
    
    .alert-info {
      background: linear-gradient(135deg, #2196F3, #1976d2);
      color: white;
      border-left: 4px solid #1565c0;
    }
    
    .alert-error {
      background: linear-gradient(135deg, #f44336, #d32f2f);
      color: white;
      border-left: 4px solid #c62828;
    }
    
    .alert-close {
      background: none;
      border: none;
      color: inherit;
      cursor: pointer;
      padding: 4px;
      border-radius: 50%;
      transition: background 0.2s ease;
      margin-left: auto;
    }
    
    .alert-close:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    #alert-box {
      position: fixed;
      top: 80px;
      right: 20px;
      z-index: 10000;
      max-width: 350px;
    }
    
    /* Notification styles for chapter pages */
    .chapter-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%);
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 12px;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #333;
      z-index: 10000;
      transform: translateX(100%);
      opacity: 0;
      transition: all 0.3s ease;
      max-width: 400px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .chapter-notification.show {
      transform: translateX(0);
      opacity: 1;
    }

    .chapter-notification.success {
      border-left: 4px solid #4CAF50;
    }

    .chapter-notification.error {
      border-left: 4px solid #f44336;
    }

    .chapter-notification .notification-content {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }

    .chapter-notification.success .notification-content i {
      color: #4CAF50;
    }

    .chapter-notification.error .notification-content i {
      color: #f44336;
    }

    .chapter-notification .notification-close {
      background: none;
      border: none;
      color: rgba(0, 0, 0, 0.5);
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
      transition: all 0.2s ease;
    }

    .chapter-notification .notification-close:hover {
      background: rgba(0, 0, 0, 0.1);
      color: #333;
    }

    @media (max-width: 480px) {
      .chapter-notification {
        top: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
      }
    }
  </style>
</head>
<body class="okuma-sayfasi">
  <!-- Ortak Navbar ve Side Menu -->
  <header>
    <div class="logo-area">
      <a href="../../index.html" class="logo-link">
        <img src="../../images/ToonNekoLogo.png" alt="Logo" />
        <span>ToonNeko</span>
      </a>
    </div>
    <nav class="desktop-navbar">
      <ul>
        <li><a href="../../index.html" style="text-decoration:none;" class="active">Anasayfa</a></li>
        <li><a href="../../tum-seriler.html" style="text-decoration:none;">Tüm Seriler</a></li>
        <li><a href="../../profile.html" style="text-decoration:none;">Profilim</a></li>
        <li><a href="../../hakkinda.html" style="text-decoration:none;">Hakkında</a></li>
        <li><a href="../../iletisim.html" style="text-decoration:none;">İletişim</a></li>
        
        <!-- Auth Buttons (Logged Out) -->
        <li id="auth-buttons-nav">
          <button id="open-register-modal-navbar" class="auth-btn">Kayıt Ol</button>
        </li>
        <li id="auth-buttons-nav-2">
          <button id="open-login-modal-navbar" class="auth-btn secondary">Giriş Yap</button>
        </li>
        
        <!-- User Info (Logged In) -->
        <li id="user-info-nav" style="display: none;">
          <span id="username-display" class="username-display"></span>
        </li>
        <li id="user-info-nav-2" style="display: none;">
          <button id="logout-btn" class="auth-btn secondary">Çıkış Yap</button>
        </li>
      </ul>
    </nav>
    <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
  </header>
  <nav class="side-menu" id="sideMenu">
    <button class="close-btn" id="closeMenu">×</button>
    <ul>
      <li><a href="../../index.html" style="text-decoration:none;" class="active">Anasayfa</a></li>
      <li><a href="../../tum-seriler.html" style="text-decoration:none;">Tüm Seriler</a></li>
      <li><a href="../../profile.html" style="text-decoration:none;">Profilim</a></li>
      <li><a href="../../hakkinda.html" style="text-decoration:none;">Hakkında</a></li>
      <li><a href="../../iletisim.html" style="text-decoration:none;">İletişim</a></li>
      
      <!-- Auth Buttons (Logged Out) -->
      <div id="side-auth-buttons">
        <li><button id="open-register-modal-side" class="auth-btn">Kayıt Ol</button></li>
        <li><button id="open-login-modal-side" class="auth-btn secondary">Giriş Yap</button></li>
      </div>
      
      <!-- User Info (Logged In) -->
      <div id="side-user-info" style="display: none;">
        <li><span id="side-username-display" class="username-display"></span></li>
        <li><button id="side-logout-btn" class="auth-btn secondary">Çıkış Yap</button></li>
      </div>
    </ul>
  </nav>
  <div class="side-overlay" id="sideOverlay"></div>

<!-- Alert Box -->
<div id="alert-box"></div>
  <div class="search-container">
    <input type="text" id="search-input" placeholder="Manhwa ara...">
    <div id="search-results" class="results-box hidden"></div>
  </div>

  <!-- Okuma Sayfası Başlık ve Navigasyon -->
  <div class="okuma-header">
    <a href="../../series/nanomachine/nanomachineseri.html" class="seri-link"><i class="fa-solid fa-arrow-left"></i> Nano Machine</a>
    <button class="fav-btn" id="bookmarkBtn" title="Bookmark'a ekle"><i class="fa-regular fa-bookmark"></i></button>
  </div>
  <div class="okuma-nav">
    <span id="chapterTitle">Bölüm 1</span>
    <div class="okuma-nav-inner" id="nav-area">
      <button id="navPrevBtn" style="display: none;"><i class="fa-solid fa-chevron-left"></i> <span id="prevBtnText">Önceki Bölüm</span></button>
      <button id="navNextBtn" ><i class="fa-solid fa-chevron-right"></i> <span id="nextBtnText">Sonraki Bölüm</span></button>
      <a href="../../series/nanomachine/nanomachineseri.html" class="info-btn" title="Seri Sayfası"><i class="fa-solid fa-circle-info"></i></a>
    </div>
  </div>
  <div class="okuma-stil-secici">
    <select id="stil" class="custom-select">
      <option value="list">Okuma Stili: Liste</option>
      <option value="page">Okuma Stili: Sayfa Sayfa</option>
    </select>
    <select id="bolumSec" class="custom-select">
      <!-- Bölüm listesi dinamik olarak yüklenecek -->
    </select>
    <select id="resimListesi" class="custom-select"><option value="1">1 / 1</option></select>
  </div>
  <div class="okuma-alani" id="okumaAlani">
    <img src="http://localhost:5506/api/image/proxy-image/1HACAKWulz2jLBtAAVALoLpGvQI0ZYq5k" 
         alt="Bölüm 1 - Sayfa 1" 
         class="okuma-img" 
         data-page="1"
         loading="lazy"
         decoding="async" onerror="this.style.display='none'; console.error('Image load error:', this.src);">
  </div>

  <!-- Bottom Navigation -->
  <div class="okuma-nav">
    <div class="okuma-nav-inner" id="nav-area-bottom">
      <button id="navPrevBtn2" style="display: none;"><i class="fa-solid fa-chevron-left"></i> <span id="prevBtnText2">Önceki Bölüm</span></button>
      <button id="navNextBtn2" ><i class="fa-solid fa-chevron-right"></i> <span id="nextBtnText2">Sonraki Bölüm</span></button>
      <a href="../../series/nanomachine/nanomachineseri.html" class="info-btn" title="Seri Sayfası"><i class="fa-solid fa-circle-info"></i></a>
    </div>
  </div>

  <!-- Yorumlar Bölümü -->
  <div class="comments-section" id="comments-nanomachine-1">
    <!-- Yorum sistemi buraya dinamik olarak yüklenecek -->
  </div>
  <button id="scrollTopBtn" title="Yukarı Çık"><i class="fas fa-arrow-up"></i></button>

  <!-- Auth Modal'ları -->
  <!-- Kayıt Formu (Modal) -->
  <div id="register-modal" class="modal">
    <div class="modal-content">
      <button id="close-register-modal" class="modal-close">&times;</button>
      <h2>Kayıt Ol</h2>
      <form id="register-form">
        <input id="register-username" type="text" placeholder="Kullanıcı Adı" required>
        <input id="register-email" type="email" placeholder="E-posta" required>
        <input id="register-password" type="password" placeholder="Şifre" required>
        <button type="submit">Kayıt Ol</button>
      </form>
      <p class="modal-switch">Zaten hesabın var mı? <a href="#" id="switch-to-login">Giriş yap</a></p>
    </div>
  </div>

  <!-- Giriş Formu (Modal) -->
  <div id="login-modal" class="modal">
    <div class="modal-content">
      <button id="close-login-modal" class="modal-close">&times;</button>
      <h2>Giriş Yap</h2>
      <form id="login-form">
        <input id="login-identifier" type="text" placeholder="E-posta veya Kullanıcı Adı" required>
        <input id="login-password" type="password" placeholder="Şifre" required>
        <button type="submit">Giriş Yap</button>
      </form>
      <p class="modal-switch">Hesabın yok mu? <a href="#" id="switch-to-register">Kayıt ol</a></p>
    </div>
  </div>

  <script>
    // Performance monitoring
    if (typeof performance !== 'undefined') {
      window.addEventListener('load', function() {
        setTimeout(function() {
          const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
          console.log('📊 Sayfa yükleme süresi:', loadTime + 'ms');
          
          // 3 saniyeden uzun yüklenme uyarısı
          if (loadTime > 3000) {
            console.warn('⚠️ Sayfa yavaş yüklendi, optimizasyon gerekebilir');
          }
        }, 0);
      });
    }
    
    // Browser extension error handling
    window.addEventListener('error', function(e) {
      if (e.filename && (e.filename.includes('myContent.js') || e.filename.includes('pagehelper.js'))) {
        e.preventDefault();
        return true;
      }
    });
    
    // Suppress browser extension console errors
    const originalError = console.error;
    console.error = function(...args) {
      const message = args.join(' ');
      if (message.includes('browser is not defined') || 
          message.includes('myContent.js') || 
          message.includes('pagehelper.js')) {
        return;
      }
      originalError.apply(console, args);
    };

    // Smart Navigation System
    const CHAPTER_CONFIG = {
      seriesName: 'nanomachine',
      seriesDisplayName: 'Nano Machine',
      currentChapter: 1,
      totalChapters: 3,
      seriesUrl: '../../series/nanomachine/nanomachineseri.html',
      chapterUrlPattern: '../nanomachine chapters/bölüm{chapter}.html'
    };

    // Okuma ilerlemesini takip et
    window.addEventListener('load', function() {
      // Sayfa yüklendiğinde bu bölümü okundu olarak işaretle
      setTimeout(() => {
        if (window.readingProgressTracker) {
          const wasNewChapter = window.readingProgressTracker.markChapterAsRead(
            CHAPTER_CONFIG.seriesName, 
            CHAPTER_CONFIG.currentChapter
          );
          
          if (wasNewChapter) {
            console.log(`New chapter marked as read: ${CHAPTER_CONFIG.seriesDisplayName} - Chapter ${CHAPTER_CONFIG.currentChapter}`);
            
            // Yeni bölüm okundu, tamamlanma önerilerini kontrol et
            checkCompletionSuggestions();
          }
        }
      }, 1000); // 1 saniye bekle ki tracker yüklensin
    });

    // Tamamlanma önerilerini kontrol et
    function checkCompletionSuggestions() {
      setTimeout(() => {
        if (window.completedSeriesTracker && window.readingProgressTracker) {
          const suggestion = window.completedSeriesTracker.suggestCompletionForSeries(CHAPTER_CONFIG.seriesName);
          
          if (suggestion.shouldSuggest) {
            // Öneriyi göster
            showCompletionSuggestion(suggestion);
          }
        }
      }, 2000); // 2 saniye bekle ki kullanıcı bölümü okumaya başlasın
    }

    // Tamamlanma önerisi göster
    function showCompletionSuggestion(suggestion) {
      const userConfirmed = confirm(suggestion.message);
      
      if (userConfirmed) {
        // Kullanıcı evet dedi, basit puanlama ve yorum sistemi
        let rating = null;
        let review = null;
        
        const ratingInput = prompt('Bu seri için puanınız (1-5, isteğe bağlı):');
        if (ratingInput) {
          const numericRating = parseInt(ratingInput);
          if (numericRating >= 1 && numericRating <= 5) {
            rating = numericRating;
          }
        }
        
        const reviewInput = prompt('Kısa bir yorum eklemek ister misiniz? (isteğe bağlı):');
        if (reviewInput && reviewInput.trim()) {
          review = reviewInput.trim();
        }
        
        const success = window.completedSeriesTracker.markSeriesAsCompleted(
          CHAPTER_CONFIG.seriesName, 
          rating, 
          review
        );
        
        if (success) {
          showNotification('🎉 Seri tamamlananlar listesine eklendi! Profil sayfandan görebilirsin.', 'success');
        } else {
          showNotification('❌ Bir hata oluştu.', 'error');
        }
      }
    }

    // Notification sistemi
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `chapter-notification ${type}`;
      notification.innerHTML = `
        <div class="notification-content">
          <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
          <span>${message}</span>
        </div>
        <button class="notification-close" onclick="this.parentElement.remove()">
          <i class="fas fa-times"></i>
        </button>
      `;
      
      document.body.appendChild(notification);
      
      // Animasyon
      setTimeout(() => notification.classList.add('show'), 100);
      
      // Otomatik kaldırma
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => notification.remove(), 300);
      }, 5000);
    }

    // Okuma stili ve navigasyon durumu
    let currentReadingMode = 'list'; // 'list' veya 'page'
    let currentPage = 1;
    const totalPages = 7;

    function updateNavigationButtons() {
      const { currentChapter, totalChapters, chapterUrlPattern } = CHAPTER_CONFIG;
      
      // Top navigation buttons
      const navPrevBtn = document.getElementById('navPrevBtn');
      const navNextBtn = document.getElementById('navNextBtn');
      const prevBtnText = document.getElementById('prevBtnText');
      const nextBtnText = document.getElementById('nextBtnText');
      
      // Bottom navigation buttons
      const navPrevBtn2 = document.getElementById('navPrevBtn2');
      const navNextBtn2 = document.getElementById('navNextBtn2');
      const prevBtnText2 = document.getElementById('prevBtnText2');
      const nextBtnText2 = document.getElementById('nextBtnText2');

      if (currentReadingMode === 'list') {
        // Liste modunda: direkt bölüm değiştir
        
        // Önceki buton mantığı
        if (currentChapter === 1) {
          navPrevBtn.style.display = 'none';
          navPrevBtn2.style.display = 'none';
        } else {
          navPrevBtn.style.display = 'inline-flex';
          navPrevBtn2.style.display = 'inline-flex';
          prevBtnText.textContent = 'Önceki Bölüm';
          prevBtnText2.textContent = 'Önceki Bölüm';
          
          const prevHandler = function() {
            const prevChapterUrl = chapterUrlPattern.replace('{chapter}', currentChapter - 1);
            window.location.href = prevChapterUrl;
          };
          navPrevBtn.onclick = prevHandler;
          navPrevBtn2.onclick = prevHandler;
        }
        
        // Sonraki buton mantığı
        if (currentChapter === totalChapters) {
          navNextBtn.style.display = 'none';
          navNextBtn2.style.display = 'none';
        } else {
          navNextBtn.style.display = 'inline-flex';
          navNextBtn2.style.display = 'inline-flex';
          nextBtnText.textContent = 'Sonraki Bölüm';
          nextBtnText2.textContent = 'Sonraki Bölüm';
          
          const nextHandler = function() {
            const nextChapterUrl = chapterUrlPattern.replace('{chapter}', currentChapter + 1);
            window.location.href = nextChapterUrl;
          };
          navNextBtn.onclick = nextHandler;
          navNextBtn2.onclick = nextHandler;
        }
        
      } else {
        // Sayfa modunda: sayfa değiştir, son sayfada bölüm değiştir
        
        // Önceki buton mantığı
        if (currentPage === 1 && currentChapter === 1) {
          navPrevBtn.style.display = 'none';
          navPrevBtn2.style.display = 'none';
        } else {
          navPrevBtn.style.display = 'inline-flex';
          navPrevBtn2.style.display = 'inline-flex';
          
          if (currentPage === 1) {
            prevBtnText.textContent = 'Önceki Bölüm';
            prevBtnText2.textContent = 'Önceki Bölüm';
          } else {
            prevBtnText.textContent = 'Önceki Sayfa';
            prevBtnText2.textContent = 'Önceki Sayfa';
          }
          
          const prevHandler = function() {
            if (currentPage > 1) {
              showPage(currentPage - 1);
            } else if (currentChapter > 1) {
              const prevChapterUrl = chapterUrlPattern.replace('{chapter}', currentChapter - 1);
              window.location.href = prevChapterUrl;
            }
          };
          navPrevBtn.onclick = prevHandler;
          navPrevBtn2.onclick = prevHandler;
        }
        
        // Sonraki buton mantığı
        if (currentPage === totalPages && currentChapter === totalChapters) {
          navNextBtn.style.display = 'none';
          navNextBtn2.style.display = 'none';
        } else {
          navNextBtn.style.display = 'inline-flex';
          navNextBtn2.style.display = 'inline-flex';
          
          if (currentPage === totalPages) {
            nextBtnText.textContent = 'Sonraki Bölüm';
            nextBtnText2.textContent = 'Sonraki Bölüm';
          } else {
            nextBtnText.textContent = 'Sonraki Sayfa';
            nextBtnText2.textContent = 'Sonraki Sayfa';
          }
          
          const nextHandler = function() {
            if (currentPage < totalPages) {
              showPage(currentPage + 1);
            } else if (currentChapter < totalChapters) {
              const nextChapterUrl = chapterUrlPattern.replace('{chapter}', currentChapter + 1);
              window.location.href = nextChapterUrl;
            }
          };
          navNextBtn.onclick = nextHandler;
          navNextBtn2.onclick = nextHandler;
        }
      }
    }

    function showPage(pageNum) {
      const images = document.querySelectorAll('.okuma-img');
      images.forEach((img, index) => {
        img.style.display = index + 1 === pageNum ? 'block' : 'none';
      });
      currentPage = pageNum;
      
      // Resim listesi dropdown'unu güncelle
      const resimListesi = document.getElementById('resimListesi');
      if (resimListesi) {
        resimListesi.value = currentPage;
      }
      
      updateNavigationButtons();
    }

    // Sayfa yüklendiğinde navigation'ı başlat
    document.addEventListener('DOMContentLoaded', function() {
      console.log('🔍 Nano Machine Chapter 1 - Universal Navigation başlatılıyor');
      console.log('CHAPTER_CONFIG:', CHAPTER_CONFIG);
      
      // Universal navigation'ı başlat
      // Simple navigation otomatik olarak çalışır
      updateNavigationButtons();
    });
  </script>
  
  <script>
    // Sayfa yüklendikten sonra fade-in efekti
    window.addEventListener('load', function() {
      document.body.classList.add('loaded');
      
      // Initialize chapter selector
      if (typeof ChapterSelector !== 'undefined') {
        new ChapterSelector(CHAPTER_CONFIG);
      }
    });

    // Scroll to top button
    window.onscroll = function() {
      const scrollTopBtn = document.getElementById('scrollTopBtn');
      if (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) {
        scrollTopBtn.style.display = 'block';
      } else {
        scrollTopBtn.style.display = 'none';
      }
    };

    document.getElementById('scrollTopBtn').onclick = function() {
      window.scrollTo({top: 0, behavior: 'smooth'});
    };

    // Okuma stili değiştirme
    document.getElementById('stil').addEventListener('change', function() {
      const stil = this.value;
      currentReadingMode = stil;
      const okumaAlani = document.getElementById('okumaAlani');
      const images = okumaAlani.querySelectorAll('img');
      
      if (stil === 'page') {
        // Sayfa sayfa modu
        images.forEach((img, index) => {
          if (index === 0) {
            img.style.display = 'block';
          } else {
            img.style.display = 'none';
          }
        });
        currentPage = 1;
      } else {
        // Liste modu
        images.forEach(img => {
          img.style.display = 'block';
        });
      }
      
      updateNavigationButtons();
    });

    // Sayfa listesi değişikliği
    document.getElementById('resimListesi').addEventListener('change', function() {
      const pageNum = parseInt(this.value);
      if (currentReadingMode === 'page') {
        showPage(pageNum);
      }
    });

    // Chapter selector will be initialized by ChapterSelector class

    // Klavye kısayolları
    document.addEventListener('keydown', function(e) {
      if (currentReadingMode === 'page') {
        if (e.key === 'ArrowLeft') {
          // Sol ok: önceki sayfa veya önceki bölüm
          const navPrevBtn = document.getElementById('navPrevBtn');
          if (navPrevBtn && navPrevBtn.style.display !== 'none') {
            navPrevBtn.click();
          }
        } else if (e.key === 'ArrowRight') {
          // Sağ ok: sonraki sayfa veya sonraki bölüm
          const navNextBtn = document.getElementById('navNextBtn');
          if (navNextBtn && navNextBtn.style.display !== 'none') {
            navNextBtn.click();
          }
        }
      }
    });

    // Resim listesi değişikliği - seçilen resme scroll
    const resimListesi = document.getElementById('resimListesi');
    if (resimListesi) {
      resimListesi.addEventListener('change', function() {
        const selectedPage = this.value;
        const targetImage = document.querySelector(`[data-page="${selectedPage}"]`);
        
        if (targetImage) {
          // Smooth scroll to the selected image
          targetImage.scrollIntoView({ 
            behavior: 'smooth', 
            block: 'center' 
          });
          
          // Optional: Add a highlight effect
          targetImage.style.boxShadow = '0 0 20px rgba(255, 111, 97, 0.8)';
          targetImage.style.transition = 'box-shadow 0.3s ease';
          
          // Remove highlight after 2 seconds
          setTimeout(() => {
            targetImage.style.boxShadow = '';
          }, 2000);
          
          console.log(`Scrolled to page ${selectedPage}`);
        }
      });
    }

    // Scroll pozisyonuna göre resim listesini güncelle
    function updateImageSelector() {
      const images = document.querySelectorAll('.okuma-img[data-page]');
      const resimListesi = document.getElementById('resimListesi');
      
      if (!images.length || !resimListesi) return;
      
      const scrollPosition = window.scrollY + window.innerHeight / 2;
      let currentPage = '1';
      
      images.forEach(img => {
        const imgTop = img.offsetTop;
        const imgBottom = imgTop + img.offsetHeight;
        
        if (scrollPosition >= imgTop && scrollPosition <= imgBottom) {
          currentPage = img.getAttribute('data-page');
        }
      });
      
      // Select değerini güncelle (sadece farklıysa)
      if (resimListesi.value !== currentPage) {
        resimListesi.value = currentPage;
      }
    }

    // Scroll event listener ekle (throttled)
    let scrollTimeout;
    window.addEventListener('scroll', function() {
      if (scrollTimeout) {
        clearTimeout(scrollTimeout);
      }
      scrollTimeout = setTimeout(updateImageSelector, 100);
    });

    // Mobil için swipe desteği
    let startX = 0;
    let endX = 0;

    document.addEventListener('touchstart', function(e) {
      startX = e.touches[0].clientX;
    });

    document.addEventListener('touchend', function(e) {
      endX = e.changedTouches[0].clientX;
      handleSwipe();
    });

    function handleSwipe() {
      const diffX = startX - endX;
      const threshold = 50;
      
      if (currentReadingMode === 'page') {
        if (diffX > threshold) {
          // Sağa swipe: sonraki sayfa/bölüm
          const navNextBtn = document.getElementById('navNextBtn');
          if (navNextBtn && navNextBtn.style.display !== 'none') {
            navNextBtn.click();
          }
        } else if (diffX < -threshold) {
          // Sola swipe: önceki sayfa/bölüm
          const navPrevBtn = document.getElementById('navPrevBtn');
          if (navPrevBtn && navPrevBtn.style.display !== 'none') {
            navPrevBtn.click();
          }
        }
      }
    }
  </script>

  <!-- Script dosyalarını yükle -->

  <script src="../../scripts/chapters.js?v=50" defer></script>
  <script src="../../scripts/dynamic-navigation.js?v=50" defer></script>
  <script src="../../scripts/arama.js?v=5" defer></script>
  <script src="../../scripts/bookmark-manager.js?v=50" defer></script>
  <script src="../../scripts/reading-progress-tracker.js?v=5" defer></script>
  <script src="../../scripts/completed-series-tracker.js?v=5" defer></script>
  <script src="../../scripts/navbar.js?v=5" defer></script>
  <script src="../../scripts/auth-navbar.js?v=5" defer></script>
  <script src="../../scripts/auth-forms.js?v=5" defer></script>
  <script src="../../scripts/comments.js?v=50&unified=true" defer></script>
  <script src="../../scripts/chapter-scripts.js?v=5" defer></script>

  
  <script>
    // Yorumlar sistemini başlat - isolated instance
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof CommentsUI !== 'undefined') {
        console.log('🔥 Nanomachine Bölüm 1 - CommentsUI başlatılıyor...');
        
        // Clear any potential shared state
        if (window.commentsUI) {
          console.log('⚠️ Cleaning up previous commentsUI instance');
          delete window.commentsUI;
        }
        
        const seriesName = 'nanomachine';
        const chapterNumber = 1;
        
        console.log(`🎯 Creating CommentsUI: ${seriesName}, chapter: ${chapterNumber}`);
        
        // Create isolated instance
        const commentsInstance = new CommentsUI(seriesName, chapterNumber);
        
        // Store for debugging only
        window.currentCommentsInstance = commentsInstance;
        
        console.log('✅ Nanomachine Bölüm 1 CommentsUI created');
      }
      
      // Okuma takibini başlat
      if (typeof ReadingTracker !== 'undefined') {
        const readingTracker = new ReadingTracker();
        readingTracker.trackReading(CHAPTER_CONFIG.seriesName, CHAPTER_CONFIG.chapterNumber, 'Nanomachine', 'Bölüm ' + CHAPTER_CONFIG.chapterNumber);
      }
    });
  </script>
</body>
</html>
